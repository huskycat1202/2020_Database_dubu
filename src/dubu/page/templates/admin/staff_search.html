{% comment %} staff search & plus {% endcomment %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <title>DuBu</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700,700i" rel="stylesheet">
    
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/open-iconic-bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/animate.css' %}">
    
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">

    <link rel="stylesheet" href="{% static 'css/aos.css' %}">

    <link rel="stylesheet" href="{% static 'css/ionicons.min.css' %}">

    <link rel="stylesheet" href="{% static 'css/bootstrap-datepicker.css' %}">
    <link rel="stylesheet" href="{% static 'css/jquery.timepicker.css' %}">

    
    <link rel="stylesheet" href="{% static 'css/flaticon.css' %}">
    <link rel="stylesheet" href="{% static 'css/icomoon.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    {% comment %} dubu_make {% endcomment %}
    <link rel="stylesheet" href="{% static 'css/dubu_made/back.css' %}">
    <link rel="stylesheet" href="{% static 'css/dubu_made/staff_s.css' %}">

    <style>
            .searchBox h4{
                display:inline;
            }
            .resultBox{
                position: relative;
                width: 1310px;
                height:250px;
                overflow:scroll;
                border:solid 1px black;
                margin-top:20px;
            }
            .resultList{
                list-style: none;
            }
            .resultList li div{
                display:inline;
            }
            table,thead,tbody,th,td{
                border:solid 1px gray;
                white-space:nowrap;
            }
    </style>
  </head>
  <body>

<!--start nav-->
    <nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
	    <div class="container">
	      <a class="navbar-brand" href="{% url 'staff' %}">Staff</a>
	      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav" aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
	        <span class="oi oi-menu"></span> Menu
	      </button>

	      <div class="collapse navbar-collapse" id="ftco-nav">
	        <ul class="navbar-nav ml-auto">
	          <li class="nav-item active"><a href="{% url 'staff' %}" class="nav-link">Staff Home</a></li>
            {% comment %} Log out {% endcomment %}
              <li class="nav-item active"><a href="{% url 'admin_logout' %}" class="nav-link">Log out</a></li>
              <li class="nav-item active"><a href="{% url 's_reservation' %}" class="nav-link">Reservation</a></li>
	          <li class="nav-item active"><a href="{% url 'room_select' %}" class="nav-link">Room select</a></li>
	          <li class="nav-item active"><a href="{% url 'parking' %}" class="nav-link">Parking</a></li>
	          <li class="nav-item active"><a href="{% url 'product' %}" class="nav-link">Product</a></li>
	          <li class="nav-item active"><a href="{% url 'engineer' %}" class="nav-link">Engineering</a></li>
	          <li class="nav-item"><a href="{% url 'staff_search' %}" class="nav-link">Search</a></li>
            <li class="nav-item active"><a href="{% url 'management' %}" class="nav-link">Management</a></li>
          </ul>
	      </div>
	    </div>
	  </nav>
<!-- END nav -->

{% comment %} top : title + background {% endcomment %}
    <div class="hero-wrap m_back">
      <div class="overlay"></div>
      <div class="container">
        <div class="row no-gutters slider-text d-flex align-itemd-end justify-content-center">
          <div class="col-md-9 ftco-animate text-center d-flex align-items-end justify-content-center">
          	<div class="text">
	            <h1 class="mb-4 bread">Staff management</h1>
            </div>
          </div>
        </div>
      </div>
    </div>
{% comment %} end top {% endcomment %}

{% comment %} main section  {% endcomment %}
<div class="staff_s_a">
<!-- 응대 가능한 직원 찾기 section-->
  <section class="search_staff_s  row_c">

      <div class="staff_s_div bold_sec">

        <div class="sub_title">Search Staff</div>
        <div class="s_i_s">
          <div class="searchBox">
                <h4>search</h4>
                <input type="text" placeholder=" team/room" id="staff_working_search">
            </div>
            <div class="resultBox">
                <table id="staff_working_tab">
                    <thead>
                        <th>이름</th><th>소속팀</th><th>담당객실</th><th>부서</th><th>역할</th><th>근무상태</th>
                    </thead>
                    <tbody>
                        {% for data in datas %}
                        <tr>
                            <td>{{data.last_name}} {{data.first_name}}</td>
                            <td>{{data.team}}</td>
                            <td class="working_search">없음</td>
                            <td class="working_search">{{data.depart_name}}</td>
                            <td>{{data.depart_position}}</td>
                            <td>{{data.status}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

      </div>

  </section>

  <!-- hotel내부의 기계들의 정보를 검색가능한 section-->
  <section class="search_staff_s  row_c">

      <div class="staff_s_div bold_sec">

        <div class="sub_title">Add or Fix Staff Info</div>

        <div class="s_i_s">
            <div class="searchBox">
                <h4>search</h4>
                <input type="text" placeholder=" name" id="staff_info_search">
            </div>
            <div class="resultBox">
                <table id="staff_result_tab">
                    <thead>
                    <th>staff_id</th><th>name</th><th>rank</th><th>depart_id</th><th>team</th><th>status</th><th>bank</th><th>account</th><th>phone</th><th>address</th><th>edit</th><th>working_time</th><th>holiday</th><th>delete</th>
                    </thead>
                    <tbody>
                    {% for data in datas %}
                    <tr><td>{{data.staff_id}}</td>
                        <td class="staff_info_name">{{data.last_name}} {{data.first_name}}</td>
                        <td>{{data.rank}}</td>
                        <td>{{data.depart_id}}</td>
                        <td>{{data.team}}</td>
                        <td>{{data.status}}</td>
                        <td>{{data.bank}}</td>
                        <td>{{data.account}}</td>
                        <td>{{data.phone}}</td>
                        <td>{{data.wide_area_unit}} {{data.basic_unit}} {{data.street}} {{data.si_gu}} {{data.eub_myeon}} {{data.building_number}} {{data.detail_address}}</td>
                        <td><input type="button" value="edit" class="edit_btn" name="edit_{{data.staff_id}}"></td>
                        <td><input type="button" value="근무일 보기/수정" class="working_btn" name="working_{{data.staff_id}}"></td>
                        <td><input type="button" value="휴가일 보기/수정" class="holiday_btn" name="holiday_{{data.staff_id}}"></td>
                        <td><form action="{% url 'delete_staff' %}" method="POST" onsubmit="return confirm('정말 제거하시겠습니까?');">
                            <input type="text" value="{{data.staff_id}}" style="display:none" name="staff_id" readonly>
                            <input type="submit" value="delete" class="delete_btn"></form></td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="addStaffBox">
                <form action="{% url 'insert_staff' %}" method="POST">
                    {% for s in names %}
                    <input type="text" name="{{s}}" placeholder="{{s}}">
                    {% endfor %}
                    <input type="submit" value="add">
                </form>
            </div>
        </div>

      </div>
      <div class="fullscreen popup" style="display:none;position:fixed;left:0px;top:0px;width:100%;height:100%;background-color:rgba(0,0,0,0.5)"></div>
        <div class="staff_info_edit popup" style="box-sizing:content-box;display:none;z-index: 100; position:fixed; width:250px; height:750px; padding:20px;left:50%; top:50%; transform:translate(-125px,-375px); background-color:rgba(255,255,255,0.8)">
            <form action="{% url 'edit_staff' %}" method="POST">
            {% for s in names %}
            {% if s != 'staff_id' %}
            <div style="display:block">
            <label style="display:block;margin:0px; margin-top:-3px; height:20px">{{s}}</label>
            <input type="text" id="staff_edit_input_{{s}}" style="height:21px; padding:1px;" name="{{s}}" placeholder="{{s}}">
            </div>
            {% else %}
            <input type="text" id="staff_edit_input_staff_id" style="height:21px; padding:1px;" name="staff_id" readonly>
            {% endif %}
            {% endfor %}
            <input type="submit" value="edit">
            </form>
        </div>
        <div class="staff_working popup" style="box-sizing:content-box;display:none;overflow:scroll;z-index:100;position:fixed;width:300px;height:600px;padding:20px;left:50%;top:50%;transform:translate(-150px,-300px);background-color:rgba(255,255,255,0.8);">
            <div>
                <table class="working_result_box">
                    <thead><th> start </th><th>end</th><th>Xday</th><th>delete</th></thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
            <div>
                <form action="{% url 'insert_staff_working' %}" method="POST">
                    <input type="text" style="display: none" name="staff_id" class="work_sid" readonly>
                    <input type="text" name="work_time_start" placeholder="starttime(00:00)">
                    <input type="text" name="work_time_end" placeholder="endtime(00:00)"><br>
                    <input type="radio" name="x_day" value="sun_day" checked>sun_day
                    <input type="radio" name="x_day" value="mon_day">mon_day
                    <input type="radio" name="x_day" value="tues_day">tues_day<br>
                    <input type="radio" name="x_day" value="wednes_day">wednes_day
                    <input type="radio" name="x_day" value="thurs_day">thurs_day
                    <input type="radio" name="x_day" value="fri_day">fri_day<br>
                    <input type="radio" name="x_day" value="satur_day">satur_day
                    <input type="submit" value="add">
                </form>
            </div>
        </div>

        <div class="staff_holiday popup" style="box-sizing:content-box;display:none;overflow:scroll;z-index:100;position:fixed;width:400px;height:600px;padding:20px;left:50%;top:50%;transform:translate(-200px,-300px);background-color:rgba(255,255,255,0.8);">
            <div>
                <table class="holiday_result_box">
                    <thead><th>start</th><th>end</th><th>type</th><th>paid</th><th>delete</th></thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
            <div>
                <form action="{% url 'insert_staff_holiday' %}" method="POST">
                    <input type="text" style="display: none" name="staff_id" class="holi_sid" readonly>
                    <input type="text" name="off_start" placeholder="startdate(0000-00-00)">
                    <input type="text" name="off_end" placeholder="enddate(0000-00-00)">
                    <input type="text" name="day_off_type" placeholder="병가 연차...">
                    <input type="text" name="is_paid" placeholder="True/False">
                    <input type="submit" value="add">
                </form>
            </div>
        </div>

      </div>
            

  </section>
</div>

    



<!-- footer -->
    <footer class="ftco-footer ftco-bg-dark ftco-section">
      <div class="container">
        <div class="row mb-5">
          <div class="col-md">
            <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">DuBu Hotel</h2>
              <p>Welcome .</p>
              <ul class="ftco-footer-social list-unstyled float-md-left float-lft mt-5">
{% comment %} 링크 추가 혹은 제거 해야합니다 {% endcomment %}
                <li class="ftco-animate"><a href="#"><span class="icon-twitter"></span></a></li>
                <li class="ftco-animate"><a href="#"><span class="icon-facebook"></span></a></li>
                <li class="ftco-animate"><a href="#"><span class="icon-instagram"></span></a></li>
              </ul>
            </div>
          </div>
          <div class="col-md">
            <div class="ftco-footer-widget mb-4 ml-md-5">
              <h2 class="ftco-heading-2">Quick menu</h2>
              <ul class="list-unstyled">
                <li><a href="{% url 'admin_logout' %}" class="py-2 d-block">Log out</a></li>
                <li><a href="{% url 'staff' %}" class="py-2 d-block">Staff home</a></li>
                <li><a href="{% url 'product' %}" class="py-2 d-block">Product</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md">
            <div class="ftco-footer-widget mb-4">
            	<h2 class="ftco-heading-2">DuBu hotel</h2>
            	<div class="block-23 mb-3">
	              <ul>
	                <li><span class="icon icon-map-marker"></span><span class="text">주소||주소||주소</span></li>
	                <li><a href="#"><span class="icon icon-phone"></span><span class="text">+0 000 0000 0000</span></a></li>
	                <li><a href="#"><span class="icon icon-envelope"></span><span class="text">DuBu@hanyang.ac.kr</span></a></li>
	              </ul>
	            </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12 text-center">

          </div>
        </div>
      </div>
    </footer>
    
  

  <!-- loader -->
  <div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px"><circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/><circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00"/></svg></div>
  
  <script src="{% static 'js/jquery.min.js' %}"></script>
  <script src="{% static 'js/jquery-migrate-3.0.1.min.js' %}"></script>
  <script src="{% static 'js/popper.min.js' %}"></script>
  <script src="{% static 'js/bootstrap.min.js' %}"></script>
  <script src="{% static 'js/jquery.easing.1.3.js' %}"></script>
  <script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
  <script src="{% static 'js/jquery.stellar.min.js' %}"></script>
  <script src="{% static 'js/owl.carousel.min.js' %}"></script>
  <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
  <script src="{% static 'js/aos.js' %}"></script>
  <script src="{% static 'js/jquery.animateNumber.min.js' %}"></script>
  <script src="{% static 'js/bootstrap-datepicker.js' %}"></script>
  <script src="{% static 'js/jquery.timepicker.min.js' %}"></script>
  <script src="{% static 'js/scrollax.min.js' %}"></script>
  <script src="{% static 'js/google-map.js' %}"></script>
  <script src="{% static 'js/main.js' %}"></script>


  </body>
</html>

<script>
    $(document).ready(function() {
        $("#staff_working_search").keyup(function() {
            var k = $(this).val();
            $("#staff_working_tab > tbody > tr").hide();
            var temp = $(".working_search:contains('" + k + "')");
            $(temp).parent().show();
        })
    })
    $(document).ready(function() {
        $("#staff_info_search").keyup(function() {
            var k = $(this).val();
            $("#staff_result_tab > tbody > tr").hide();
            var temp = $(".staff_info_name:contains('" + k + "')");

            $(temp).parent().show();
        })
    })
    $(".fullscreen").click(function(){
        $(".popup").css("display","none");
    })

    $(".edit_btn").click(function(){
        $(".fullscreen").css("display","block");
        $(".staff_info_edit").css("display","block");
        var staff_id = $(this).attr('name').slice(5);
        {% for data in datas %}
        if(staff_id == '{{data.staff_id}}'){
            $('#staff_edit_input_staff_id').attr('value','{{data.staff_id}}')
            $('#staff_edit_input_rank').attr('value','{{data.rank}}')
            $('#staff_edit_input_status').attr('value','{{data.status}}')
            $('#staff_edit_input_depart_id').attr('value','{{data.depart_id}}')
            $('#staff_edit_input_team').attr('value','{{data.team}}')
            $('#staff_edit_input_first_name').attr('value','{{data.first_name}}')
            $('#staff_edit_input_last_name').attr('value','{{data.last_name}}')
            $('#staff_edit_input_phone').attr('value','{{data.phone}}')
            $('#staff_edit_input_bank').attr('value','{{data.bank}}')
            $('#staff_edit_input_account').attr('value','{{data.account}}')
            $('#staff_edit_input_wide_area_unit').attr('value','{{data.wide_area_unit}}')
            $('#staff_edit_input_street').attr('value','{{data.street}}')
            $('#staff_edit_input_basic_unit').attr('value','{{data.basic_unit}}')
            $('#staff_edit_input_si_gu').attr('value','{{data.si_gu}}')
            $('#staff_edit_input_eub_myeon').attr('value','{{data.eub_myeon}}')
            $('#staff_edit_input_building_number').attr('value','{{data.building_number}}')
            $('#staff_edit_input_detail_address').attr('value','{{data.detail_address}}')
        }
        {% endfor %}
    })

    $(".working_btn").click(function(){
        $(".fullscreen").css("display","block");
        $(".staff_working").css("display","block");
        $(".working_result_box tbody").empty();
        var staff_id = $(this).attr('name').slice(8);
        $(".work_sid").attr('value',staff_id);
        {% for data in working_datas %}
        if(staff_id == '{{data.staff_id}}'){
            $('.working_result_box tbody').append("<tr><td>{{data.work_time_start}}</td><td>{{data.work_time_end}}</td><td>{{data.x_day}}</td><td><form action=\"{% url 'delete_staff_working' %}\" method='POST'><input type='text' value='{{data.id}}' name='id' style='display:none;' readonly><input type='submit' value='delete'></form></td></tr>");
        }
        
        {% endfor %}
    })

    $(".holiday_btn").click(function(){
        $(".fullscreen").css("display","block");
        $(".staff_holiday").css("display","block");
        $(".holiday_result_box tbody").empty();
        var staff_id = $(this).attr('name').slice(8);
        $(".holi_sid").attr('value',staff_id);
        {% for data in holiday_datas %}
        if(staff_id == '{{data.staff_id}}'){
            $('.holiday_result_box tbody').append("<tr><td>{{data.off_start}}</td><td>{{data.off_end}}</td><td>{{data.day_off_type}}</td><td>{{data.is_paid}}</td><td><form action=\"{% url 'delete_staff_holiday' %}\" method='POST'><input type='text' value='{{data.id}}' name='id' style='display:none;' readonly><input type='submit' value='delete'></form></td></tr>");
        }
        
        {% endfor %}
    })


</script>